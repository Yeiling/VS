<?xml version="1.0" encoding="utf-8" ?>
<nlog xmlns="http://www.nlog-project.org/schemas/NLog.xsd"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.nlog-project.org/schemas/NLog.xsd NLog.xsd"
      autoReload="true"
      throwExceptions="false"
      internalLogLevel="Info"
      internalLogFile="./logs/nlog-internal.log">

  <target name="database" xsi:type="Database">
    <connectionString>server=39.105.178.182:3588;Database=SYT_apiDB_Test;user id=Test_sa;password=data2018!</connectionString>

    <!--
  Script for creating the dbo.Log table.
      
  SET ANSI_NULLS ON
  SET QUOTED_IDENTIFIER ON
  CREATE TABLE [dbo].[Log] (
	  [Id] [int] IDENTITY(1,1) NOT NULL,
	  [MachineName] [nvarchar](50) NOT NULL,
	  [Logged] [datetime] NOT NULL,
	  [Level] [nvarchar](50) NOT NULL,
	  [Message] [nvarchar](max) NOT NULL,
	  [Logger] [nvarchar](250) NULL,
	  [Callsite] [nvarchar](max) NULL,
	  [Exception] [nvarchar](max) NULL,
    CONSTRAINT [PK_dbo.Log] PRIMARY KEY CLUSTERED ([Id] ASC)
      WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
  ) ON [PRIMARY]
  -->
    <commandText>
      insert into dbo.Log (
      MachineName, Logged, Level, Message,
      Logger, Callsite, Exception
      ) values (
      @MachineName, @Logged, @Level, @Message,
      @Logger, @Callsite, @Exception
      );
    </commandText>

    <parameter name="@MachineName" layout="${machinename}" />
    <parameter name="@Logged" layout="${date}" />
    <parameter name="@Level" layout="${level}" />
    <parameter name="@Message" layout="${message}" />
    <parameter name="@Logger" layout="${logger}" />
    <parameter name="@Callsite" layout="${callsite}" />
    <parameter name="@Exception" layout="${exception:tostring}" />
  </target>
  
  
  
  <!--<target xsi:type="Database" name="LMDBLogTarget">
      -->
  <!-- 数据库链接字段 -->
  <!--
      <dbProvider>System.Data.SqlClient</dbProvider>
      <connectionString>server=39.105.178.182:3588;Initial Catalog=SYT_apiDB_Test;Persist Security Info=True;User ID=Test_sa;Password=data2018!;</connectionString>
      -->
  <!-- SQL command to be executed for each entry -->
  <!--
      <commandText>
        INSERT INTO [SystemLogs](createDate,origin,logLevel,message,stackTrace)
        VALUES(@createDate,@origin,@logLevel,@message,@stackTrace)
      </commandText>
      -->
  <!-- parameters for the command -->
  <!--
      -->
  <!--创建日期-->
  <!--
      <parameter name="@createDate" layout="${event-properties:item=createDate}" />
      -->
  <!--日记来源-->
  <!--
      <parameter name="@origin" layout="${event-properties:item=origin}" />
      -->
  <!--日志级别-->
  <!--
      <parameter name="@logLevel" layout="${event-properties:item=logLevel}" />
      -->
  <!--异常信息-->
  <!--
      <parameter name="@message" layout=" ${event-properties:item=message}" />
      -->
  <!--堆栈信息-->
  <!--
      <parameter name="@stackTrace" layout="${event-properties:item=stackTrace}" />
    </target>
  </targets>
  <rules>
    <logger name="LMDBLog" minlevel="Debug" writeTo="LMDBLogTarget" final="true"  />
  </rules>-->


</nlog>


<!--NLog 根节点以下几种配置需要注意

autoReload:配置修改是否自动加载。
throwExceptions:日志出现异常时是否需要抛出异常，若配置为true日志记录异常时由于没有捕获异常，会导致程序挂掉。
internalLogLevel:表示nlog日志的执行日志记录等级。
internalLogFile:表示nlog日志的执行日志记录的位置。通过./XXXX的方式可以配置到程序的相对目录。-->
